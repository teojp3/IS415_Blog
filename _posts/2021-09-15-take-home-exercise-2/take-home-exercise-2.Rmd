---
title: "Take Home Exercise 2"
description: |
  A study on the distribution of Airbnb Listings in Singapore, and how has COVID-19 impacted them.
author:
  - name: Teo Jun Peng
    url: https://teojp3-is415.netlify.app/
date: 09-29-2021
output:
  distill::distill_article:
      self_contained: false
      toc: true
      toc_depth: 2
      toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.align = "center", tidy.opts=list(width.cutoff=80),tidy=TRUE)
```

# 1. Introduction

Singapore is one of the few countries that does not legalise short-term rentals for properties, a minimum stay of three months is still required for rental of properties as of [2019](https://www.todayonline.com/singapore/short-term-home-sharing-remains-illegal-singapore-airbnb-disappointed). Therefore, it was surprising to discover data sets for Airbnb listings located in Singapore in [Inside Airbnb]('http://insideairbnb.com/about.html'). But we shall dive deeper into this phenomenon of Airbnb being allowed in Singapore perhaps another day. 

For this exercise, we will utilising those data sets to generate useful insights through:

- Analysing the distribution of Airbnb listings in Pre-COVID Singapore using 2019 dataset
- Analysing the impact of COVID-19 on these listings based on the most updated 2021 dataset

## 1.1 The Data

For analysis purposes, the following data are used:

- Airbnb listings for June 2019 and June 2021 from [Inside Airbnb]('http://insideairbnb.com/get-the-data.html')

- Various geospatial data sets of choice extracted from SLA OneMap Service, using [OneMap.Sg API]('https://cran.r-project.org/web/packages/onemapsgapi/index.html')

# 2. Setting up the environment

To begin the study, R packages will be used for efficiency and a more comprehensive analysis, such as *tidyverse* and *sf* etc.

```{r results='hide'}

packages <- c('readr','maptools', 'sf', 'raster', 'spatstat', 'tmap', 'tidyverse', 'plotly', 'ggthemes')
for (p in packages)
  {
  if(!require(p, character.only = T))
    {
    install.packages(p)
  }
  library(p,character.only = T)
}
```

# 3. Data Wrangling

## 3.1 Aspatial Data

### 3.1.1 Importing Aspatial Data from 2019 AirBnb listingsdataset

```{r}
airbnb_2019 <- read_csv("data/the2data/airbnb2019.csv") 
```

```{r}
sg_hotels <- read_csv("data/the2data/OneMapData/hotels.csv") 
```

The coordinate fields of **airbnb_2019** seem to be in decimal degrees. Hence, `WGS84` referencing system is assumed.

## Converting the aspatial data frame into sf object

```{r}
sf_2019 <- st_as_sf(airbnb_2019,
                    coords = c("latitude", 
                               "longitude"),
                    crs = 3414) %>%
  st_transform(crs = 3414)
```

```{r}
hotels_sf <- st_as_sf(sg_hotels,
                    coords = c("Lat",
                               "Lng"),
                    crs = 3414) %>%
  st_transform(crs = 3414)
```

Checking and ensuring Projected Coordinates Systems of the sf object is correct

```{r}
st_crs(sf_2019)
```


```{r}
tmap_mode("plot")
tm_shape(sf_2019) +
  tm_dots(alpha = 0.4,
          col = "blue",
          size = 0.05) +
  tm_shape(hotels_sf) +
  tm_dots(alpha = 0.4,
          col = "red",
          size = 0.05)
```



# References

- Short-term home sharing remains illegal in Singapore; Airbnb disappointed
https://www.todayonline.com/singapore/short-term-home-sharing-remains-illegal-singapore-airbnb-disappointed 
